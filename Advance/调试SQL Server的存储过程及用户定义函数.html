<SPAN style="BORDER-RIGHT: #999999 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px solid; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 13px;  PADDING-BOTTOM: 5px; MARGIN: 0px; BORDER-LEFT: #999999 0px solid; WIDTH: 515px; COLOR: #0000ff; LINE-HEIGHT: 16px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px solid; BACKGROUND-REPEAT: repeat-x; HEIGHT: 28px">1、在查询分析器中调试 </SPAN>
<P style="BORDER-RIGHT: #0099cc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #0099cc 1px solid; PADDING-LEFT: 5px; FONT-SIZE: 12px; PADDING-BOTTOM: 5px; MARGIN: 5px; BORDER-LEFT: #0099cc 1px solid; WIDTH: auto; COLOR: #000000; LINE-HEIGHT: 18px; PADDING-TOP: 5px; BORDER-BOTTOM: #0099cc 1px solid; FONT-FAMILY: ' BACKGROUND-COLOR: #ddedfb; Verdana: ; quot: ; Courier: ; mono:">查询分析器中调试的步骤如下：<BR>&nbsp;&nbsp;&nbsp;&nbsp;SQL 2000查询分析器<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--左连的对象浏览器(没有的话按F8)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--对象项中<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--右键调试的存储过程<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--调试<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--输入参数(必须输入所有的参数,包括默认值/输出参数<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--点击执行<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--出现一个浮动工具条<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--上面有单步执行，断点设置等<BR><BR>按F11是单步执行.<BR><BR>如果要运行到指定行,只需要将光标移动到指定的行,再按Ctrl+F10</P>
<P><SPAN style="BORDER-RIGHT: #999999 0px solid; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px solid; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 13px;  PADDING-BOTTOM: 5px; MARGIN: 0px; BORDER-LEFT: #999999 1px solid; WIDTH: 40px; COLOR: #0000ff; LINE-HEIGHT: 16px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px solid; BACKGROUND-REPEAT: no-repeat; HEIGHT: 28px"></SPAN><SPAN style="BORDER-RIGHT: #999999 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px solid; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 13px;  PADDING-BOTTOM: 5px; MARGIN: 0px; BORDER-LEFT: #999999 0px solid; WIDTH: 515px; COLOR: #0000ff; LINE-HEIGHT: 16px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px solid; BACKGROUND-REPEAT: repeat-x; HEIGHT: 28px">2、通过输出存储过程或用户定义函数的处理结果进行调试 </SPAN></P>
<P style="BORDER-RIGHT: #0099cc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #0099cc 1px solid; PADDING-LEFT: 5px; FONT-SIZE: 12px; PADDING-BOTTOM: 5px; MARGIN: 5px; BORDER-LEFT: #0099cc 1px solid; WIDTH: auto; COLOR: #339966; LINE-HEIGHT: 18px; PADDING-TOP: 5px; BORDER-BOTTOM: #0099cc 1px solid; FONT-FAMILY: ' BACKGROUND-COLOR: #fafafa; Verdana: ; quot: ; Courier: ; mono:">&nbsp;&nbsp;&nbsp;&nbsp;如果没办法使用查询分析器调试存储过程，可以直接在存储过程中添加 PRINT 或者 SELECT 语句，输出存储过程各步骤的执行结果。对于用户定义函数，不能使用 PRINT 或者 SELECT 语句输出各步骤的执行结果，要调度用户定义函数，可以将用户定义函数改成存储过程，调试成功后再改回用户定义函数。</P>
<P><SPAN style="BORDER-RIGHT: #999999 0px solid; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px solid; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 13px;  PADDING-BOTTOM: 5px; MARGIN: 0px; BORDER-LEFT: #999999 1px solid; WIDTH: 40px; COLOR: #0000ff; LINE-HEIGHT: 16px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px solid; BACKGROUND-REPEAT: no-repeat; HEIGHT: 28px"></SPAN><SPAN style="BORDER-RIGHT: #999999 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px solid; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 13px;  PADDING-BOTTOM: 5px; MARGIN: 0px; BORDER-LEFT: #999999 0px solid; WIDTH: 515px; COLOR: #0000ff; LINE-HEIGHT: 16px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px solid; BACKGROUND-REPEAT: repeat-x; HEIGHT: 28px">3、在C#中调试</SPAN> </P>
<P style="BORDER-RIGHT: #0099cc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #0099cc 1px solid; PADDING-LEFT: 5px; FONT-SIZE: 12px; PADDING-BOTTOM: 5px; MARGIN: 5px; BORDER-LEFT: #0099cc 1px solid; WIDTH: auto; COLOR: #000000; LINE-HEIGHT: 18px; PADDING-TOP: 5px; BORDER-BOTTOM: #0099cc 1px solid; FONT-FAMILY: ' BACKGROUND-COLOR: #ddedfb; Verdana: ; quot: ; Courier: ; mono:">菜单中,选择"工具"--"连接到数据库"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;选择"视图"--"服务器资源管理器"<BR>在服务器资源管理器中,右键要调试的存储过程或者用户定义函数--单步执行.</P>
<P><SPAN style="BORDER-RIGHT: #999999 0px solid; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px solid; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 13px;  PADDING-BOTTOM: 5px; MARGIN: 0px; BORDER-LEFT: #999999 1px solid; WIDTH: 40px; COLOR: #0000ff; LINE-HEIGHT: 16px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px solid; BACKGROUND-REPEAT: no-repeat; HEIGHT: 28px"></SPAN><SPAN style="BORDER-RIGHT: #999999 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #999999 1px solid; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 13px;  PADDING-BOTTOM: 5px; MARGIN: 0px; BORDER-LEFT: #999999 0px solid; WIDTH: 515px; COLOR: #0000ff; LINE-HEIGHT: 16px; PADDING-TOP: 5px; BORDER-BOTTOM: #999999 1px solid; BACKGROUND-REPEAT: repeat-x; HEIGHT: 28px">4、保障查询分析器或者C#中能成功调试的几个事项</SPAN> </P>
<P style="BORDER-RIGHT: #0099cc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #0099cc 1px solid; PADDING-LEFT: 5px; FONT-SIZE: 12px; PADDING-BOTTOM: 5px; MARGIN: 5px; BORDER-LEFT: #0099cc 1px solid; WIDTH: auto; COLOR: #339966; LINE-HEIGHT: 18px; PADDING-TOP: 5px; BORDER-BOTTOM: #0099cc 1px solid; FONT-FAMILY: ' BACKGROUND-COLOR: #fafafa; Verdana: ; quot: ; Courier: ; mono:">1.&nbsp;&nbsp;&nbsp;远程sql服务器的mssqlserver服务要求使用指定用户(不是本地系统用户)，最好是administrator启动。<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;控制面板--管理工具--服务--右键mssqlserver--属性--登录中，将登录身份改为“此帐户”，并设置对应的用户名及密码。<BR>2.&nbsp;&nbsp;&nbsp;登录远程sql的用户使用sa<BR>3.&nbsp;&nbsp;&nbsp;远程sql服务器要求未禁用调试功能，执行下面的语句开启调试功能：<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sp_sdidebug legacy_on<BR>4.&nbsp;&nbsp;&nbsp;保证调试与被调试的电脑的sql server版本一致，无论是客户端,还是服务器，最好都安装sql sp4。<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;检查SQ ServerL有没有打补丁的方法是在查询分析器中运行：<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select @@version<BR>&nbsp;&nbsp;&nbsp;&nbsp; 如果出来的版本号是8.00.2039以下,则表明未安装sp4的补丁。<BR>&nbsp;&nbsp;&nbsp;&nbsp; <A href="http://www.microsoft.com/downloads/details.aspx?FamilyId=8E2DFC8D-C20E-4446-99A9-B7F0213F8BC5&amp;displaylang=zh-cn"><U><FONT color=#0000ff>全部补丁的位置</FONT></U></A>(在下载页的中间部分,可以选择语言,必须保证下载的补丁语言和sql server实例语言对应) <BR>&nbsp;&nbsp;&nbsp;&nbsp; <A href="http://download.microsoft.com/download/9/b/f/9bff6646-2cdb-4069-ada0-548be9cb9338/SQL2000-KB884525-SP4-x86-CHS.EXE"><U><FONT color=#0000ff>简体中文版式SQL Server 2000应该安装的补丁</FONT></U></A><BR>注意：<BR>&nbsp;&nbsp;&nbsp;&nbsp; <A href="http://download.microsoft.com/download/9/b/f/9bff6646-2cdb-4069-ada0-548be9cb9338/SQL2000-KB884525-SP4-x86-CHS.EXE"></A>a.&nbsp;&nbsp;补丁下载后,执行的时候是解压,要在解压后的目录中执行setup.bat才是真正的安装<BR>&nbsp;&nbsp;&nbsp;&nbsp; <A href="http://download.microsoft.com/download/9/b/f/9bff6646-2cdb-4069-ada0-548be9cb9338/SQL2000-KB884525-SP4-x86-CHS.EXE"></A>b.&nbsp;&nbsp;如果的操作系统是xp,那么在安装xp sp2后,不管以前是否安装过sql sp4,都要再安装一次,并且在防火墙中开启1433端口,否则无法被其他电脑访问。<BR>&nbsp;&nbsp;&nbsp;&nbsp; <A href="http://download.microsoft.com/download/9/b/f/9bff6646-2cdb-4069-ada0-548be9cb9338/SQL2000-KB884525-SP4-x86-CHS.EXE"></A>c.&nbsp;&nbsp;windows 2003上运行机制的 SQL Server 必须安装sp3或者更高的补丁版本。</P>